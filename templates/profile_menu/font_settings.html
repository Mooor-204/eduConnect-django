{% extends 'base.html' %}

{% block title %}Font Size Settings{% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="row">
        <div class="col-md-6 offset-md-3">
            <div class="card">
                <div class="card-header">
                    <h4 class="mb-0">Font Size Settings</h4>
                </div>
                <div class="card-body">

                    {% if messages %}
                    <div class="mb-3">
                        {% for message in messages %}
                        <div class="alert alert-success alert-dismissible fade show">
                            {{ message }}
                            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                        </div>
                        {% endfor %}
                    </div>
                    {% endif %}
                    
                    <form method="POST" id="font-form">
                        {% csrf_token %}
                        
                        <div class="mb-4">
                            <label class="form-label fw-bold">Select Font Size:</label>
                            
                            <div class="form-check mb-3 p-3 border rounded">
                                <input class="form-check-input" type="radio" name="font_size" id="small" value="1">
                                <label class="form-check-label d-block" for="small">
                                    <strong>Small</strong><br>
                                    <small class="text-muted">14px - For large screens</small>
                                </label>
                            </div>
                            
                            <div class="form-check mb-3 p-3 border rounded bg-light">
                                <input class="form-check-input" type="radio" name="font_size" id="medium" value="3" checked>
                                <label class="form-check-label d-block" for="medium">
                                    <strong>Medium (Recommended)</strong><br>
                                    <small class="text-muted">16px - Default size</small>
                                </label>
                            </div>
                            
                            <div class="form-check mb-3 p-3 border rounded">
                                <input class="form-check-input" type="radio" name="font_size" id="large" value="5">
                                <label class="form-check-label d-block" for="large">
                                    <strong>Large</strong><br>
                                    <small class="text-muted">18px - Best for readability</small>
                                </label>
                            </div>
                        </div>
                        
                        <div class="d-grid gap-2">
                            <button type="submit" class="btn btn-primary btn-lg">
                                <i class="fas fa-save me-2"></i>Save Settings
                            </button>
                            <a href="{% url 'settings' %}" class="btn btn-outline-secondary">
                                <i class="fas fa-arrow-left me-2"></i>Back to Settings
                            </a>
                        </div>
                    </form>
                    
                    
                    <div class="mt-4 p-3 border rounded bg-light">
                        <h6><i class="fas fa-eye me-2"></i>Live Preview:</h6>
                        <div class="p-3 bg-white rounded border">
                            <p id="preview-text" class="mb-1">
                                This text shows how your selection will look across the entire website.
                                The font size will apply to all pages automatically.
                            </p>
                            <small id="preview-small" class="text-muted">
                                Smaller text like captions or notes will also scale appropriately.
                            </small>
                        </div>
                        <div class="mt-2 text-center">
                            <button onclick="testFontChange()" class="btn btn-sm btn-success">
                                <i class="fas fa-bolt me-1"></i>Click to Test Immediately
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>

document.addEventListener('DOMContentLoaded', function() {
    const savedSize = localStorage.getItem('user_font_size') || '3';
    document.getElementById(savedSize === '1' ? 'small' : savedSize === '5' ? 'large' : 'medium').checked = true;
    updatePreview(savedSize);
});

document.querySelectorAll('input[name="font_size"]').forEach(radio => {
    radio.addEventListener('change', function() {
        updatePreview(this.value);
    });
});


function updatePreview(size) {
    const sizeMap = {
        '1': { text: '14px', small: '12px', label: 'Small' },
        '3': { text: '16px', small: '14px', label: 'Medium' },
        '5': { text: '18px', small: '15px', label: 'Large' }
    };
    
    const preview = sizeMap[size] || sizeMap['3'];
    document.getElementById('preview-text').style.fontSize = preview.text;
    document.getElementById('preview-small').style.fontSize = preview.small;
}
document.getElementById('font-form').addEventListener('submit', function(e) {
    const selected = document.querySelector('input[name="font_size"]:checked');
    if (selected) {
        
        localStorage.setItem('user_font_size', selected.value);
        const sizeMap = {
            '1': '14px',
            '3': '16px', 
            '5': '18px'
        };
        
        if (sizeMap[selected.value]) {
            document.documentElement.style.fontSize = sizeMap[selected.value];
        }
        
        setTimeout(() => {
            alert('âœ… Font size saved! The entire site will now use ' + 
                  (selected.value === '1' ? 'Small' : 
                   selected.value === '3' ? 'Medium' : 'Large') + ' size.');
        }, 100);
    }
});
function testFontChange() {
    localStorage.setItem('user_font_size', '5');
    document.documentElement.style.fontSize = '20px'; 
    document.getElementById('preview-text').innerHTML = 'ðŸŽ‰ SUCCESS! Font changed to LARGE size!';
    document.getElementById('preview-text').style.fontSize = '20px';
    document.getElementById('preview-text').style.color = 'green';
    document.getElementById('preview-text').style.fontWeight = 'bold';
    document.getElementById('large').checked = true;
    
    alert('âœ… Test successful! Font changed to Large (20px).');
}
</script>

<style>
.form-check-input:checked {
    background-color: #0d6efd;
    border-color: #0d6efd;
}
#preview-text, #preview-small {
    transition: font-size 0.3s ease;
}
</style>
{% endblock %}